[03/13/2021 00:10:25.0820] [0] **********************************************
[03/13/2021 00:10:25.0836] [0] Starting Microsoft Exchange Server 2016 Setup
[03/13/2021 00:10:25.0836] [0] **********************************************
[03/13/2021 00:10:25.0867] [0] Local time zone: (UTC-06:00) Central Time (US & Canada).
[03/13/2021 00:10:25.0867] [0] Operating system version: Microsoft Windows NT 6.2.9200.0.
[03/13/2021 00:10:25.0867] [0] Setup version: 15.1.2106.2.
[03/13/2021 00:10:25.0867] [0] Logged on user: SOLO\Han.
[03/13/2021 00:10:25.0945] [0] Command Line Parameter Name='iacceptexchangeserverlicenseterms', Value=''.
[03/13/2021 00:10:25.0945] [0] Command Line Parameter Name='mode', Value='Upgrade'.
[03/13/2021 00:10:25.0945] [0] Command Line Parameter Name='sourcedir', Value='G:\'.
[03/13/2021 00:10:26.0881] [0] RuntimeAssembly was started with the following command: '/IAcceptExchangeServerLicenseTerms /Mode:Upgrade /sourcedir:G:"'.
[03/13/2021 00:10:26.0881] [0] The registry key, HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Exchange\v8.0, wasn't found.
[03/13/2021 00:10:26.0881] [0] The registry key, HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ExchangeServer\v14, wasn't found.
[03/13/2021 00:10:26.0896] [0] Copying Files...
[03/13/2021 00:10:26.0896] [0] Starting copy from G:\Setup\ServerRoles\Common to C:\Windows\Temp\ExchangeSetup.
[03/13/2021 00:10:31.0592] [0] Finished copy from G:\Setup\ServerRoles\Common to C:\Windows\Temp\ExchangeSetup.
[03/13/2021 00:10:31.0592] [0] File copy complete.  Setup will now collect additional information needed for installation.

[03/13/2021 00:10:31.0592] [0] Assembly dll file location is C:\Windows\Temp\ExchangeSetup\Microsoft.Exchange.Setup.Console.dll
[03/13/2021 00:10:37.0380] [0] Setup is choosing the domain controller to use
[03/13/2021 00:10:37.0739] [0] The MSExchangeADTopology has a persisted domain controller: DC2.Solo.local
[03/13/2021 00:10:40.0219] [0] PrepareAD has been run, and has replicated to this domain controller; so setup will use DC2.Solo.local
[03/13/2021 00:10:40.0219] [0] Setup is choosing a global catalog...
[03/13/2021 00:10:40.0297] [0] Setup has chosen the global catalog server DC2.Solo.local.
[03/13/2021 00:10:40.0797] [0] Setup will use the domain controller 'DC2.Solo.local'.
[03/13/2021 00:10:40.0812] [0] Setup will use the global catalog 'DC2.Solo.local'.
[03/13/2021 00:10:40.0812] [0] Exchange configuration container for the organization is 'CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=Solo,DC=local'.
[03/13/2021 00:10:40.0828] [0] Exchange organization container for the organization is 'CN=SoloORG,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=Solo,DC=local'.
[03/13/2021 00:10:40.0875] [0] Setup will search for an Exchange Server object for the local machine with name 'ExSvr1'.
[03/13/2021 00:10:41.0202] [0] Exchange Server object found : 'CN=ExSvr1,CN=Servers,CN=Exchange Administrative Group (FYDIBOHF23SPDLT),CN=Administrative Groups,CN=SoloORG,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=Solo,DC=local'.
[03/13/2021 00:10:41.0405] [0] The following roles have been unpacked: BridgeheadRole ClientAccessRole MailboxRole UnifiedMessagingRole FrontendTransportRole AdminToolsRole CafeRole 
[03/13/2021 00:10:41.0405] [0] The following datacenter roles are unpacked: 
[03/13/2021 00:10:41.0421] [0] The following roles are installed: BridgeheadRole ClientAccessRole MailboxRole UnifiedMessagingRole FrontendTransportRole AdminToolsRole CafeRole 
[03/13/2021 00:10:41.0436] [0] The local server has some Exchange files installed.
[03/13/2021 00:10:41.0467] [0] Server Name=ExSvr1
[03/13/2021 00:10:41.0483] [0] Setup will use the path 'G:\' for installing Exchange.
[03/13/2021 00:10:41.0499] [0] Setup will discover the installed roles from server object 'CN=ExSvr1,CN=Servers,CN=Exchange Administrative Group (FYDIBOHF23SPDLT),CN=Administrative Groups,CN=SoloORG,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=Solo,DC=local'.
[03/13/2021 00:10:41.0499] [0] 'BridgeheadRole' is installed on the server object.
[03/13/2021 00:10:41.0499] [0] 'ClientAccessRole' is installed on the server object.
[03/13/2021 00:10:41.0499] [0] 'MailboxRole' is installed on the server object.
[03/13/2021 00:10:41.0499] [0] 'UnifiedMessagingRole' is installed on the server object.
[03/13/2021 00:10:41.0499] [0] 'CafeRole' is installed on the server object.
[03/13/2021 00:10:41.0499] [0] 'FrontendTransportRole' is installed on the server object.
[03/13/2021 00:10:41.0499] [0] The backup copy of the install path is 'C:\Program Files\Microsoft\Exchange Server\V15'.
[03/13/2021 00:10:41.0499] [0] The backup copy of the previously installed version is '15.1.1713.5'.
[03/13/2021 00:10:41.0499] [0] The installation mode is set to: 'BuildToBuildUpgrade'.
[03/13/2021 00:10:50.0063] [0] An Exchange organization with name 'SoloORG' was found in this forest.
[03/13/2021 00:10:50.0063] [0] Active Directory Initialization status : 'True'.
[03/13/2021 00:10:50.0063] [0] Schema Update Required Status : 'False'.
[03/13/2021 00:10:50.0063] [0] Organization Configuration Update Required Status : 'False'.
[03/13/2021 00:10:50.0063] [0] Domain Configuration Update Required Status : 'False'.
[03/13/2021 00:10:50.0063] [0] The locally installed version is 15.1.2106.2.
[03/13/2021 00:10:50.0063] [0] Exchange Installation Directory : 'C:\Program Files\Microsoft\Exchange Server\V15'.
[03/13/2021 00:10:50.0157] [0] Setup is determining what organization-level operations to perform.
[03/13/2021 00:10:50.0172] [0] Because the value was specified, setup is setting the argument OrganizationName to the value SoloORG.
[03/13/2021 00:10:50.0172] [0] The installed MSI is current for this version of Setup.
[03/13/2021 00:10:50.0188] [0] RootDataHandler has 1 DataHandlers
[03/13/2021 00:10:50.0188] [0]      Languages
[03/13/2021 00:10:50.0188] [0]      Management tools
[03/13/2021 00:10:50.0188] [0]      Mailbox role: Transport service
[03/13/2021 00:10:50.0188] [0]      Mailbox role: Client Access service
[03/13/2021 00:10:50.0188] [0]      Mailbox role: Unified Messaging service
[03/13/2021 00:10:50.0188] [0]      Mailbox role: Mailbox service
[03/13/2021 00:10:50.0188] [0]      Mailbox role: Front End Transport service
[03/13/2021 00:10:50.0204] [0]      Mailbox role: Client Access Front End service
[03/13/2021 00:10:50.0219] [0] Validating options for the 7 requested roles
[03/13/2021 00:10:50.0219] [0] UpgradeModeDataHandler has 11 handlers and 11 work units
[03/13/2021 00:10:50.0297] [0] Performing Microsoft Exchange Server Prerequisite Check
[03/13/2021 00:10:50.0781] [0] **************
[03/13/2021 00:10:59.0065] [1] Evaluated [Setting:ComputerNameDnsFullyQualified] [HasException:False] [Value:"ExSvr1.Solo.local"] [ParentValue:"<NULL>"] [Thread:7] [Duration:00:00:00]
[03/13/2021 00:48:56.0091] [2] Active Directory session settings for 'Set-OwaVirtualDirectory' are: View Entire Forest: 'True', Configuration Domain Controller: 'DC2.Solo.local', Preferred Global Catalog: 'DC2.Solo.local', Preferred Domain Controllers: '{ DC2.Solo.local }'
[03/13/2021 00:48:56.0091] [2] User specified parameters:  -Identity:'ExSvr1\OWA (Exchange Back End)' -FormsAuthentication:'False' -WindowsAuthentication:'True'
[03/13/2021 00:48:56.0091] [2] Beginning processing set-OwaVirtualdirectory
[03/13/2021 00:48:56.0123] [2] Searching objects "ExSvr1\OWA (Exchange Back End)" of type "ADOwaVirtualDirectory" under the root "$null".
[03/13/2021 00:48:56.0138] [2] Previous operation run on domain controller 'DC2.Solo.local'.
[03/13/2021 00:48:56.0138] [2] [ERROR] The operation couldn't be performed because object 'ExSvr1\OWA (Exchange Back End)' couldn't be found on 'DC2.Solo.local'.
[03/13/2021 00:48:56.0138] [2] Ending processing set-OwaVirtualdirectory
[03/13/2021 00:48:56.0216] [2] Beginning processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0216] [2] Update-AppPoolManagedFrameworkVersion beginning...
[03/13/2021 00:48:56.0216] [2] Ending processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0216] [2] Beginning processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0232] [2] MSExchangeOWAAppPool
[03/13/2021 00:48:56.0232] [2] Ending processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0232] [2] Beginning processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0232] [2] v4.0
[03/13/2021 00:48:56.0232] [2] Ending processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0310] [2] Beginning processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0310] [2] Update succeeded.
[03/13/2021 00:48:56.0310] [2] Ending processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0310] [2] Beginning processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0310] [2] Update-AppPoolManagedFrameworkVersion beginning...
[03/13/2021 00:48:56.0310] [2] Ending processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0310] [2] Beginning processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0325] [2] MSExchangeOWACalendarAppPool
[03/13/2021 00:48:56.0325] [2] Ending processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0325] [2] Beginning processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0325] [2] v4.0
[03/13/2021 00:48:56.0325] [2] Ending processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0372] [2] Beginning processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0388] [2] Update succeeded.
[03/13/2021 00:48:56.0388] [2] Ending processing Write-ExchangeSetupLog
[03/13/2021 00:48:56.0388] [1] The following 1 error(s) occurred during task execution:
[03/13/2021 00:48:56.0388] [1] 0.  ErrorRecord: The operation couldn't be performed because object 'ExSvr1\OWA (Exchange Back End)' couldn't be found on 'DC2.Solo.local'.
[03/13/2021 00:48:56.0388] [1] 0.  ErrorRecord: Microsoft.Exchange.Configuration.Tasks.ManagementObjectNotFoundException: The operation couldn't be performed because object 'ExSvr1\OWA (Exchange Back End)' couldn't be found on 'DC2.Solo.local'.
   at Microsoft.Exchange.Configuration.Tasks.DataAccessTask`1.GetDataObject[TObject](IIdentityParameter id, IConfigDataProvider session, ObjectId rootID, OptionalIdentityData optionalData, Func`2 notFoundError, Func`2 multipleFoundError, ExchangeErrorCategory errorCategory)
   at Microsoft.Exchange.Configuration.Tasks.SetObjectWithIdentityTaskBase`3.ResolveDataObject()
   at Microsoft.Exchange.Configuration.Tasks.SetSystemConfigurationObjectTask`3.ResolveDataObject()
   at Microsoft.Exchange.Configuration.Tasks.SetObjectTaskBase`2.PrepareDataObject()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetVirtualDirectory`1.PrepareDataObject()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetExchangeVirtualDirectory`1.PrepareDataObject()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetWebAppVirtualDirectory`1.PrepareDataObject()
   at Microsoft.Exchange.Configuration.Tasks.SetTaskBase`1.InternalValidate()
   at Microsoft.Exchange.Configuration.Tasks.SetSystemConfigurationObjectTask`3.InternalValidate()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetExchangeVirtualDirectory`1.InternalValidate()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetWebAppVirtualDirectory`1.InternalValidate()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetOwaVirtualDirectory.InternalValidate()
   at Microsoft.Exchange.Configuration.Tasks.Task.<ProcessRecord>b__91_1()
   at Microsoft.Exchange.Configuration.Tasks.Task.InvokeRetryableFunc(String funcName, Action func, Boolean terminatePipelineIfFailed)
[03/13/2021 00:48:56.0388] [1] [ERROR] The following error was generated when "$error.Clear(); 
          $windowsAuthenticationEnabled = $true
          [Reflection.Assembly]::LoadWithPartialName('Microsoft.Exchange.Clients.Owa2.ServerVariantConfiguration');
          try
          {
             $snapshot = [Microsoft.Exchange.VariantConfiguration.OwaServer.OwaServerConfiguration]::GetSnapshot([Microsoft.Exchange.VariantConfiguration.MachineSettingsContext]::Local)
             if (($snapshot -ne $null) -and ($snapshot.WindowsAuthenticationDisabled -ne $null) -and $snapshot.WindowsAuthenticationDisabled.Enabled)
             {
                Write-ExchangeSetupLog -info "WindowsAuthenticationDisabled is true, disabling windows authentication on vdir..."
                $windowsAuthenticationEnabled = $false
             }
             else
             {
                Write-ExchangeSetupLog -info "WindowsAuthenticationDisabled is false, enabling windows authentication on vdir..."
             }
          }
          catch
          {
             Write-ExchangeSetupLog -info $_
          }
          Update-OwaVirtualDirectory -DomainController $RoleDomainController;
          $BEVdirIdentity = $RoleNetBIOSName + "\OWA (Exchange Back End)";
          set-OwaVirtualdirectory -Identity $BEVdirIdentity -FormsAuthentication:$false -WindowsAuthentication:$windowsAuthenticationEnabled;
          . "$RoleInstallPath\Scripts\Update-AppPoolManagedFrameworkVersion.ps1" -AppPoolName:"MSExchangeOWAAppPool" -Version:"v4.0";
          . "$RoleInstallPath\Scripts\Update-AppPoolManagedFrameworkVersion.ps1" -AppPoolName:"MSExchangeOWACalendarAppPool" -Version:"v4.0";
        " was run: "Microsoft.Exchange.Configuration.Tasks.ManagementObjectNotFoundException: The operation couldn't be performed because object 'ExSvr1\OWA (Exchange Back End)' couldn't be found on 'DC2.Solo.local'.
   at Microsoft.Exchange.Configuration.Tasks.DataAccessTask`1.GetDataObject[TObject](IIdentityParameter id, IConfigDataProvider session, ObjectId rootID, OptionalIdentityData optionalData, Func`2 notFoundError, Func`2 multipleFoundError, ExchangeErrorCategory errorCategory)
   at Microsoft.Exchange.Configuration.Tasks.SetObjectWithIdentityTaskBase`3.ResolveDataObject()
   at Microsoft.Exchange.Configuration.Tasks.SetSystemConfigurationObjectTask`3.ResolveDataObject()
   at Microsoft.Exchange.Configuration.Tasks.SetObjectTaskBase`2.PrepareDataObject()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetVirtualDirectory`1.PrepareDataObject()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetExchangeVirtualDirectory`1.PrepareDataObject()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetWebAppVirtualDirectory`1.PrepareDataObject()
   at Microsoft.Exchange.Configuration.Tasks.SetTaskBase`1.InternalValidate()
   at Microsoft.Exchange.Configuration.Tasks.SetSystemConfigurationObjectTask`3.InternalValidate()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetExchangeVirtualDirectory`1.InternalValidate()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetWebAppVirtualDirectory`1.InternalValidate()
   at Microsoft.Exchange.Management.SystemConfigurationTasks.SetOwaVirtualDirectory.InternalValidate()
   at Microsoft.Exchange.Configuration.Tasks.Task.<ProcessRecord>b__91_1()
   at Microsoft.Exchange.Configuration.Tasks.Task.InvokeRetryableFunc(String funcName, Action func, Boolean terminatePipelineIfFailed)".
[03/13/2021 00:48:56.0388] [1] [ERROR] The operation couldn't be performed because object 'ExSvr1\OWA (Exchange Back End)' couldn't be found on 'DC2.Solo.local'.
[03/13/2021 00:48:56.0388] [1] [ERROR-REFERENCE] Id=ClientAccessOwaComponent___62bd834915a7470798aa47ba1f2b6800 Component=EXCHANGE14:\Current\Release\Shared\Datacenter\Setup
[03/13/2021 00:48:56.0388] [1] Setup is stopping now because of one or more critical errors.
[03/13/2021 00:48:56.0388] [1] Finished executing component tasks.
[03/13/2021 00:48:57.0948] [1] Ending processing Install-ClientAccessRole
[03/13/2021 00:48:57.0963] [0] CurrentResult console.ProcessRunInternal:198: 1
[03/13/2021 00:48:57.0963] [0] CurrentResult launcherbase.maincore:90: 1
[03/13/2021 00:48:57.0963] [0] CurrentResult console.startmain:52: 1
[03/13/2021 00:48:57.0963] [0] CurrentResult SetupLauncherHelper.loadassembly:452: 1
[03/13/2021 00:48:58.0026] [0] The Exchange Server setup operation didn't complete.  More details can be found in ExchangeSetup.log located in the <SystemDrive>:\ExchangeSetupLogs folder.
[03/13/2021 00:48:58.0369] [0] CurrentResult main.run:235: 1
[03/13/2021 00:48:58.0369] [0] CurrentResult setupbase.maincore:396: 1
[03/13/2021 00:48:58.0369] [0] End of Setup
[03/13/2021 00:48:58.0369] [0] **********************************************
